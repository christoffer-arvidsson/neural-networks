#+TITLE: One Layer Perceptron

* Libraries
#+begin_src jupyter-python :kernel ml
import sys
sys.path.append('../src')

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from model import Perceptron
#+end_src

#+RESULTS:


* Data normalization
#+begin_src jupyter-python :kernel ml
names = ['x_1', 'x_2', 'y']
training_set = pd.read_csv('../datasets/training_set.csv', sep=',', header=None, names=names)
validation_set = pd.read_csv('../datasets/validation_set.csv', sep=',', header=None, names=names)

g = sns.scatterplot(data=training_set, x='x_1', y='x_2', hue='y', legend=True, s=8.0)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/1ec76b3f772c88a60ce2c02a83eb7e5289234b5c.png]]

#+begin_src jupyter-python :kernel ml
x_train = training_set.values[:,:2]
x_train_normalized = (x_train - x_train.mean()) / x_train.std()
y_train = training_set.values[:,-1]

x_val = validation_set.values[:,:2]
x_val_normalized = (x_val - x_train.mean()) / x_train.std()
y_val = validation_set.values[:,-1]
#+end_src

#+RESULTS:

* Model
#+begin_src jupyter-python :kernel ml
seed = None
epochs = 1000
learning_rate = 0.01
patience = 50
layer_sizes = [2, 8, 4, 1]
rng = np.random.default_rng(seed)

net = Perceptron(layer_sizes, rng)

net.train(x_train_normalized,
          y_train,
          x_val_normalized,
          y_val,
          epochs,
          learning_rate=learning_rate,
          patience=patience)

#+end_src

#+RESULTS:
: Epoch: 128/1000,	step: 1280000,	energy_train: 1984.8405,	error_val: 0.1170


#+begin_src jupyter-python :kernel ml :file ../img/perceptron_classification.png
y_pred = np.zeros_like(y_train)
for i, x in enumerate(x_train_normalized):
    y_pred[i] = np.sign(net.predict(x))

prediction = pd.DataFrame({
    'x_1': x_train_normalized[:,0],
    'x_2': x_train_normalized[:,1],
    'y_true': y_train,
    'y_pred': y_pred,
    'correct': y_train == y_pred
})
g = sns.scatterplot(data=prediction, x='x_1', y='x_2', hue='y_pred', legend=True, s=8.0)
#+end_src

#+RESULTS:
[[file:../img/perceptron_classification.png]]
